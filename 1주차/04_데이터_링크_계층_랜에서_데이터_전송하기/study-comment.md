# 4장 데이터 링크 계층: 랜에서 데이터 전송하기

## 데이터 링크 계층의 역할과 이더넷

---

**데이터링크 계층**

- 네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층

**이더넷**

- 네트워크 장비 간에 신호를 주고받는 규칙 중 가장 많이 사용되는 규칙
- 랜에서 적용되는 규칙
- 허브와 같은 장비에 연결된 컴퓨터와 데이터를 주고 받을 때 사용

---

❗️허브는 전기 신호를 전달받은 포트를 제외한 나머지 포트에 전달하기 때문에 관계없는 다른 컴퓨터들이 그 데이터를 볼 수 있다.

데이터의 내용을 못보게 하는 방법

- 보내려는 데이터에 목적지 정보를 추가해서 보내고 목적지 이외의 컴퓨터는 데이터를 받더라도 무시할 수 있다.

---

❗️허브는 들어온 데이터를 그대로 모든 포트에 보내기만 한다.(더미 허브)

따라서 컴퓨터 여러 대가 동시에 데이터를 보내면 데이터들이 서로 부딪힐 수 있다. ⇒ 충돌(collision)

이러한 충돌을 피하기 위해 이더넷을 사용한다.

이더넷은 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않는 구조이기때문이다.

데이터를 보내는 시점을 늦추는 방법을 통해 충돌을 예방할 수 있는데 이것을 CSMA.CD라고 한다.

---

**CSMA/CD**

CS는 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지를 확인하는 규칙이다.

MA는 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋다는 규칙이다.

CD는 충돌이 발생하고 있는지를 확인하는 규칙이다.

이러한 규칙을 따르면 충돌이 일어나지 않는다.

예전에는 이 방식을 잘 사용했는데 현재는 효율이 좋지 않다는 이유로 잘 사용하지 않는다.

❗️그럼 어떻게 충돌하지 않도록 유지했는가?

- 스위치(switch)라는 네트워크 장비를 사용해서 충돌을 피했다.

---

## MAC 주소의 구조

랜 카드는 비트열(0과 1)을 전기 신호로 변환한다.

랜 카드에는 MAC 주소라는 번호가 정해져 있다.

**MAC 주소**

- 제조할 때 새겨지기 때문에 물리 주소라고 부른다.
- 전 세계에서 유일한 번호로 할당되어 있다.
- 중복되지 않도록 규칙이 명확하게 정해져 있다.
- 48비트 숫자로 구성되어 있다.
- 앞쪽 24비트는 랜 카드를 만든 제조사 번호
- 뒤쪽 24비트는 제조사가 랜 카드에 붙인 일련번호

**MAC 주소를 사용한 통신**

- OSI 모델에서는 데이터 링크 계층에 해당하고 TCP/IP 모델에서는 네트워크 계층에 해당하는데, 이 계층에서 이더넷 헤더와 트레일러를 붙인다.
- 이더넷 헤더는 목적지의 MAC 주소(6바이트), 출발지 MAC 주소(6바이트), 유형(2바이트) 이렇게 총 14바이트로 구성되어 있다.
- 이더넷 유형은 이더넷으로 전송되는 상위 계층 프로토콜의 종류를 나타낸다.

이더넷 헤더 외에 데이터 뒤에 추가하는 것 ⇒ 트레일러

이것은 FCS(Frame Check Sequence)라고도 하는데, 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용한다.

이더텟 헤더와 트레일러가 추가된 데이터 ⇒ 프레임

네트워크를 통해 프레임이 전송된다.

---

## 스위치의 구조

**스위치**

- 데이터 링크 계층에서 동작하고 레이어 2 스위치 또는 스위칭 허브라고 불린다.
- 외형은 허브와 비슷
- 스위치 내부에는 MAC 주소 테이블(MAC address table)이라는 것이 있다.
  MAC 주소 테이블은 스위치의 포트 번호와 해당 포트에 연결 되어 있는 컴퓨터의 MAC 주소가 등록되는 데이터베이스
- 스위치의 전원이 켜진 상태에서는 MAC 주소 테이블에 아무것도 등록되어 있지 않다.
  하지만 컴퓨터에서 목적지 MAC 주소가 추가된 프레임이라는 데이터가 전송되면 MAC 주소 테이블을 확인하고 출발지 MAC 주소가 등록되어 있지 않으면 MAC 주소를 포트와 함께 등록한다. > MAC 주소 학습 기능
- 컴퓨터 1에서 컴퓨터 3에게 데이터를 전송하는 시점에 아직 컴퓨터 3의 목적지 MAC 주소가 MAC 주소 테이블에 등록되어 있지 않아서 송신 포트 이외의 포트에 데이터가 전송되는데 이러한 데이터 전송을 플러딩(flooding)이라고 한다.
- 만약 MAC 주소 테이블에 목적지 MAC 주소가 등록되어 있을 경우
  스위치의 MAC 주소 테이블에 컴퓨터 3의 MAC주소가 등록되어 있다고 가정한다면 컴퓨터 2,4,5에는 데이터가 전송되지 않고 컴퓨터 3에만 전송된다.
- 쉽게 말해 MAC 주소가 등록되어 있으면 목적지 컴퓨터에만 데이터가 전송되는 것이다.
- 주소를 기준으로 목적지를 선택하는 것을 MAC 주소 필터링이라고 한다. 이는 불필요한 데이터를 네트워크에 전송하지 않게 되는 것이다.

---

## 데이터가 케이블에서 충돌하지 않는 구조

**전이중 통신 방식**

데이터 송수신을 동시에 통신하는 방식

**반이중 통신 방식**

회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식

❗️어느 방식을 사용하는 것이 좋을까

- 전이중 통신 방식은 데이터를 동시에 전송해도 충돌이 발생하지 않지만, 반이중 통신 방식은 데이터를 동시에 전송하면 충돌이 발생한다.
- 컴퓨터 1과 컴퓨터  2를 직접 랜 케이블로 연결한다고 가정 했을 때 여덟 개, 즉 선을 네 쌍 사용하기 때문에 전이중 통신 방식이 되는 것이다.
- 반면 허브 내부에는 송수신이 나누어져 있지 않기 때문에 컴퓨터 1과  컴퓨터 2를 허브로 연결하면 동시에 데이터를 보낼 때 충돌이 일어난다. 이처럼 허브를 사용하면 회선 하나를 송신과 수신이 번갈아가면서 사용하는 반이중 방식을 사용하게 된다.

❗️**허브가 아닌 스위치일 경우**

- 스위치는 충돌이 일어나지 않는 구조로 되어 있기 때문에 전이중 통신방식으로도 데이터를 주고받을 수 있다.
- 허브를 사용하면 충돌이 생기면서 네트워크 지연이 발생하기 때문에 최근에는 네트워크로 스위치를 사용하는 것이 표준이다.
- 스위치는 전송하면서 동시에 수신도 가능해서 효율이 높다.

**충돌 도메인**

- 충돌이 발생할 때 그 영향이 미치는 범위
- 허브는 연결되어 있는 컴퓨터 전체가 하나의 충돌 도메인이 된다.
- 즉, 허브는 충돌의 영향이 모든 컴퓨터에 미친다.
- 스위치는 데이터를 동시에 송수신할 수 있는 전이중 통신 방식이기 때문에 충돌이 일어나지 않고 충돌 도메인의 범위도 좁다.
- 충돌 도메인의 범위가 넓을수록 네트워크가 지연된다.

---

## 이더넷의 종류와 특징

이더넷은 케이블 종류나 통신 속도에 따라 다양한 규격으로 분류된다.

**BASE**

- 10BASE-T를 대표로 설명해보면 첫 번째 10은 Mbps 단위인 통신 속도로 10Mbps라는 뜻이다.
- BASE는 BASEBAND라는 전송 방식을 나타내고, T는 케이블 종류를 나타낸다.
- 하이픈(-) 뒤는 케이블 길이나 케이블 종류를 나타내지만, 동축 케이블은 케이블의 최대 길이를 100미터 단위로 표시한다.
- 예를 들어 10BASE5는 케이블의 최대 길이가 500미터이므로 5로 표시되어 있어요.
- UTP 케이블은 케이블 종류를 표시하는데, 10BASE-T는 UTP 케이블을 말하는 것이다.